/* 40921727 */
const input = `59708072843556858145230522180223745694544745622336045476506437914986923372260274801316091345126141549522285839402701823884690004497674132615520871839943084040979940198142892825326110513041581064388583488930891380942485307732666485384523705852790683809812073738758055115293090635233887206040961042759996972844810891420692117353333665907710709020698487019805669782598004799421226356372885464480818196786256472944761036204897548977647880837284232444863230958576095091824226426501119748518640709592225529707891969295441026284304137606735506294604060549102824977720776272463738349154440565501914642111802044575388635071779775767726626682303495430936326809`.split('').map(a => parseInt(a));

function getPattern(i, j) {
    j = (j + 1) % (++i * 4);

    if (j < i) {
        return 0;
    }
    
    if (j < i * 2) {
        return 1;
    }

    if (j < i * 3) {
        return 0;
    }

    return -1;
}

const r = (f, x, times) => times ? r(f, f(x), times - 1) : x;

function fft(a) {
    for (let i = 0; i < a.length / 2; i++) {
        for (let j = i + 1; j < a.length; j++) {
            a[i] += getPattern(i, j) * a[j];
        }
        a[i] = Math.abs(a[i]) % 10;
    }

    let sum = 0;
    for (let i = a.length - 1; i >= a.length / 2; i--) {
        sum += a[i];
        a[i] = sum % 10;
    }

    return a;
}

const start = +new Date();
console.log(r(fft, input, 100).slice(0, 8).join(''));
console.log('done', +new Date() - start);
